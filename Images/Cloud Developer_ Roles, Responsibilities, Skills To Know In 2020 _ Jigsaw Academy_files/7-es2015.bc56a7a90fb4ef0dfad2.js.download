(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{DCOW:function(t,e,i){"use strict";i.r(e),i.d(e,"ChatminModule",(function(){return w}));var n=i("ofXK"),s=i("tyNb"),o=i("J1Ni"),r=i("fXoL"),a=i("NtaL"),c=i("miJO"),h=i("jzuh"),g=i("fkdK"),l=i("6R2t"),p=i("tzqc");const d=["konversationStarter"],u=function(t,e,i){return{sid:t,current_url:e,current_title:i}};function m(t,e){if(1&t){const t=r.Qb();r.Pb(0,"div",6,7),r.Kb(2,"div",8),r.Pb(3,"div",9),r.Wb("click",(function(e){return r.tc(t),r.ac().hideStarter(e)})),r.Kb(4,"img",10),r.Ob(),r.Ob()}if(2&t){const t=r.ac();r.jc("routerLink","/chat/",t.entityID,""),r.hc("queryParams",r.nc(4,u,t.senderID,t.currentURL,t.currentTitle))("@onConversationStart",void 0),r.xb(2),r.hc("innerHTML",t.conversationStarter.text,r.uc)}}function b(t,e){if(1&t&&(r.Pb(0,"div",11),r.Pb(1,"div"),r.Pb(2,"b"),r.Cc(3),r.Ob(),r.Ob(),r.Ob()),2&t){const t=r.ac();r.xb(3),r.Dc(t.unreadCount)}}const v=function(t){return{current_url:t}},f=[{path:"",component:(()=>{class t{constructor(t,e,i,n,s,o,r,a,c){this.sendService=t,this.activeRoute=e,this.appConfig=i,this.cookieService=n,this.cdRef=s,this.stateService=o,this.socket=r,this.storageService=a,this.router=c,this.conversationStarter=null,this.speakingAllowed=!1,this.unreadCount=0,this.mobileCheck=function(){let t=!1;var e;return e=navigator.userAgent||navigator.vendor,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},this.listenToSocketEvents=()=>{let t=this;this.socket.init(this.entityID,this.senderID,{onNewMessage:function(e){t.socket.getIsChatOpen()||(t.startConversation(),t.sendService.sendDelivery(t.entityID,t.senderID,e.metadata.msgId,"D",t.currentURL),e.message&&e.message.text&&t.showMessage(e))}})}}ngOnInit(){if(window.hasOwnProperty("webkitSpeechRecognition")&&(this.speakingAllowed=!0),this.paramSub=this.activeRoute.paramMap.subscribe(t=>{this.entityID=t.get("entityID"),this.senderID=this.activeRoute.snapshot.queryParamMap.get("sid"),this.senderID||(this.senderID=this.cookieService.getIdentity(this.entityID)),this.agentMessage=this.storageService.retrieve("kvch-"+this.entityID)||[],this.unreadCount=this.storageService.retrieve("unread-"+this.entityID)||0}),this.currentURL=this.activeRoute.snapshot.queryParams.current_url,this.currentTitle=this.activeRoute.snapshot.queryParams.current_title,this.appConfig.settings$.subscribe(t=>{this.settings=t,"true"===this.cookieService.getCookieDoc(this.entityID+"_CSTD")||"started"==this.stateService.getState()||this.mobileCheck()||this.mobileCheck()||(this.conversationStarter="string"==typeof this.settings.welcome?{text:this.settings.welcome}:this.settings.welcome)}),this.listenToSocketEvents(),"true"===this.cookieService.getCookieDoc(this.entityID+"_CSTD")||"started"==this.stateService.getState());else{navigator;var t=this.mobileCheck();this.settings.enable_expand_desktop&&!t&&setTimeout(()=>{this.router.navigateByUrl("/chat/"+this.entityID+"?sid="+this.senderID+"&current_url="+(this.currentURL||"")+"&current_title="+(this.currentTitle||"")),this.startConversation()},1500),this.settings.enable_expand_mobile&&t&&setTimeout(()=>{this.router.navigateByUrl("/chat/"+this.entityID+"?sid="+this.senderID+"&current_url="+(this.currentURL||"")+"&current_title="+(this.currentTitle||"")),this.startConversation()},1500)}}showMessage(t){this.conversationStarter={text:t.message.text},this.unreadCount+=1,this.storageService.store("unread-"+this.entityID,this.unreadCount),this.socket.getChatOpenedOnce()||this.showRemoteMessage(t)}showRemoteMessage(t){let e=null;this.agentMessage.length>0&&(e=this.agentMessage[this.agentMessage.length-1][0].direction),"remote"===e?this.agentMessage[this.agentMessage.length-1].push(this.getTextTemplate(t)):this.agentMessage.push([this.getTextTemplate(t)]),console.log("Storing 3"),this.storageService.store("kvch-"+this.entityID,this.agentMessage)}addMessage(t){this.agentMessage.push(this.getTextTemplate(t)),this.storageService.store("kvch-"+this.entityID,this.agentMessage)}getTextTemplate(t){return{channel:t.channel,direction:"remote",timeOfMessage:(new Date).getTime(),message:{type:"text",text:t.message.text},metadata:t.metadata,isRead:!1}}startDictation(t){let e=t.target;if("PATH"==e.tagName.toUpperCase()?e=e.parentElement.parentElement:"SVG"==e.tagName.toUpperCase()&&(e=e.parentElement),e.classList.add("active"),window.hasOwnProperty("webkitSpeechRecognition")){this.speakingAllowed=!0;let t=new window.webkitSpeechRecognition;t.continuous=!1,t.interimResults=!1,t.lang="en - IN",t.start(),t.onresult=function(i){e.classList.remove("active"),alert(i.results[0][0].transcript),t.stop()},t.onerror=function(e){t.stop()}}}ngOnDestroy(){console.log("Destroyed"),this.socket.destroy(),this.paramSub&&this.paramSub.unsubscribe()}ngAfterViewInit(){if(this.conversationStarter&&this.conversationStarter>""){let t=this;t.cdRef.detectChanges(),t.startConversation()}}hideStarter(t){t.stopPropagation(),this.conversationStarter=null,this.cookieService.setCookie(this.entityID+"_CSTD","true"),window.parent.postMessage({event:"close"},"*")}startConversation(){let t=this.cookieService.getCookieDoc(this.entityID+"_CSTD");this.stateService.startConversation(),console.log("is open",t,document.body.offsetHeight),t||window.parent.postMessage({event:"start",height:document.body.offsetHeight+"px"},"*")}}return t.\u0275fac=function(e){return new(e||t)(r.Jb(a.a),r.Jb(s.a),r.Jb(c.a),r.Jb(h.a),r.Jb(r.h),r.Jb(g.a),r.Jb(l.a),r.Jb(p.a),r.Jb(s.b))},t.\u0275cmp=r.Db({type:t,selectors:[["app-chatmin"]],viewQuery:function(t,e){var i;1&t&&r.Gc(d,!0),2&t&&r.qc(i=r.Xb())&&(e.kstarter=i.first)},decls:6,vars:13,consts:[["href","javascript:void(0)","class","konverse-starter",3,"routerLink","queryParams",4,"ngIf"],["class","unread-msg",4,"ngIf"],[1,"fabx",3,"ngClass","routerLink","queryParams"],["href","javascript:void(0)",3,"routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","width","32","height","32","viewBox","0 0 640 640","shape-rendering","geometricPrecision","text-rendering","geometricPrecision","image-rendering","optimizeQuality","fill-rule","evenodd","clip-rule","evenodd"],["d","M466.116 26.445H173.884c-65.056 0-118.289 53.233-118.289 118.29v208.75c0 65.044 53.233 118.29 118.289 118.29h91.89c-13.145 52.004-29.066 98.74-77.717 141.875 93.013-23.788 164.813-71.87 217.503-141.876h15.886c65.056 0 162.96-53.233 162.96-118.289v-208.75c0-65.057-53.233-118.29-118.29-118.29zM451.706 213.9c-23.705 0-42.921 19.229-42.921 42.934s19.216 42.922 42.921 42.922 42.934-19.217 42.934-42.922-19.229-42.934-42.934-42.934zm-263.413 0c-23.705 0-42.921 19.229-42.921 42.934s19.216 42.922 42.921 42.922 42.934-19.217 42.934-42.922-19.229-42.934-42.934-42.934zm131.706 0c-23.705 0-42.933 19.229-42.933 42.934s19.228 42.922 42.933 42.922 42.934-19.217 42.934-42.922-19.229-42.934-42.934-42.934zM173.883 0H466.151v.095c39.886.012 76.064 16.24 102.202 42.39l-.047.059c26.185 26.209 42.437 62.375 42.449 102.178h.094v.012h-.094v208.75h.094v.024h-.094c-.012 42.556-29.575 79.631-68.966 105.521-36.673 24.119-82.985 39.084-120.332 39.095v.095h-.011v-.095h-3c-26.375 32.86-56.99 60.899-92.057 83.93-38.764 25.454-82.619 44.647-131.824 57.226l-.011-.083c-9.26 2.35-19.465-.437-26.233-8.079-9.638-10.901-8.622-27.567 2.268-37.205 21.449-19.016 35.681-38.811 45.969-59.552 5.74-11.551 10.346-23.622 14.362-36.142H173.85v-.095c-39.887-.011-76.052-16.252-102.202-42.39-26.15-26.162-42.39-62.34-42.402-102.237h-.095v-.012h.095v-208.75h-.095v-.036h.095c.011-39.071 15.65-74.6 40.937-100.62.46-.542.945-1.074 1.453-1.582C97.785 16.347 133.975.107 173.86.095V.001h.023z","fill-rule","nonzero"],["href","javascript:void(0)",1,"konverse-starter",3,"routerLink","queryParams"],["konversationStarter",""],[1,"konverse-starter-content",3,"innerHTML"],[1,"close",3,"click"],["src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAQAAAD8x0bcAAAAvklEQVR4AZXSAQaDUBzH8YCgK2yD3WTAGrFJmN2izpCOsI4wlE6wjlA3SczY1HfTD3vUog/4q6/e817WQqyIKGloKIlYjQOHnB5TT45jJjY1U2rsX5TyT2oJWzoAbgRo6ggo0LRVFCPed/Z48xqmIxIrqhC9PLBTjNSKnoB0+MOTMx0gD0XtKPKNqJ1azsWdWi5B9ubGOSGJog36eMFl4gjWlnCdPUzBppq9FsEhG11whi7YxJpQvwp3Qu1lgQ+5p3w6irRAlQAAAABJRU5ErkJggg==","alt",""],[1,"unread-msg"]],template:function(t,e){1&t&&(r.Ac(0,m,5,8,"div",0),r.Ac(1,b,4,1,"div",1),r.Pb(2,"div",2),r.Pb(3,"a",3),r.Zb(),r.Pb(4,"svg",4),r.Kb(5,"path",5),r.Ob(),r.Ob(),r.Ob()),2&t&&(r.hc("ngIf",e.conversationStarter&&e.conversationStarter.text),r.xb(1),r.hc("ngIf",e.unreadCount>0),r.xb(1),r.jc("routerLink","/chat/",e.entityID,""),r.hc("ngClass","")("queryParams",r.lc(7,v,e.currentURL)),r.xb(1),r.jc("routerLink","/chat/",e.entityID,""),r.hc("queryParams",r.nc(9,u,e.senderID,e.currentURL,e.currentTitle)))},directives:[n.l,n.j,s.c,s.d],styles:['.speak-talk[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:row;justify-content:center;align-items:center;height:100px;width:100px;border-radius:100%;background:#fff;box-shadow:0 0 20px 0 rgba(0,0,0,.25);left:-40px;top:-7px;background-color:var(--header-bg);margin-top:35px;cursor:pointer}.speak-talk[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:relative;font-size:72px;top:5px;left:-5px}.speak-talk[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:30px;fill:#fff;stroke:#fff}.speak-talk.active[_ngcontent-%COMP%]:after{-webkit-animation-delay:.5s;animation-delay:.5s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:cubic-bezier(.65,0,.34,1);animation-timing-function:cubic-bezier(.65,0,.34,1)}.speak-talk.active[_ngcontent-%COMP%]:after, .speak-talk.active[_ngcontent-%COMP%]:before{opacity:0;display:flex;flex-direction:row;justify-content:center;align-items:center;position:absolute;right:0;bottom:0;content:"";height:100%;width:100%;border:8px solid rgba(0,0,0,.2);border-radius:100%;-webkit-animation-name:ripple;animation-name:ripple;-webkit-animation-duration:1.5s;animation-duration:1.5s;z-index:-1}.speak-talk.active[_ngcontent-%COMP%]:before{-webkit-animation-delay:0s;animation-delay:0s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:cubic-bezier(.65,0,.34,1);animation-timing-function:cubic-bezier(.65,0,.34,1)}.unread-msg[_ngcontent-%COMP%]{background-color:#ff7300;border-radius:50%;padding:2px 10px 6px 6px;color:#fff;font-weight:700;margin-bottom:-15px;position:relative;z-index:150;width:20px;height:20px;font-size:12px}@-webkit-keyframes ripple{0%{opacity:1;transform:scale3d(.75,.75,1)}to{opacity:0;transform:scale3d(1.5,1.5,1)}}@keyframes ripple{0%{opacity:1;transform:scale3d(.75,.75,1)}to{opacity:0;transform:scale3d(1.5,1.5,1)}}[_nghost-%COMP%]{flex-direction:column;align-items:flex-end;overflow:hidden}.fabx[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex}.fabx[_ngcontent-%COMP%]{background-color:var(--chat-icon-bg);background-size:cover;width:56px;height:56px;text-align:center;align-items:center;flex-direction:row;margin:0 10px 10px;border-radius:10px}.fabx[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%}.fabx[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#fff;fill:#fff}.fabx.micAllowed[_ngcontent-%COMP%]{position:relative;left:-48px}.konverse-starter[_ngcontent-%COMP%]{margin:10px;min-width:300px;text-align:right}.konverse-starter[_ngcontent-%COMP%]   .konverse-starter-content[_ngcontent-%COMP%]{background:var(--conversation-bg);color:var(--conversation-color);height:auto;display:inline-block;box-shadow:-1px 0 5px rgba(0,0,0,.1);cursor:pointer;border-radius:12px;border-bottom-right-radius:0;padding:15px;text-align:left;font-size:14px}.close[_ngcontent-%COMP%]{position:absolute;top:-5px;right:18px;opacity:1}.close[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{background-color:#222;border-radius:50%}'],data:{animation:[o.a]}}),t})()}];let k=(()=>{class t{}return t.\u0275mod=r.Hb({type:t}),t.\u0275inj=r.Gb({factory:function(e){return new(e||t)},imports:[[s.e.forChild(f)],s.e]}),t})(),w=(()=>{class t{}return t.\u0275mod=r.Hb({type:t}),t.\u0275inj=r.Gb({factory:function(e){return new(e||t)},imports:[[n.c,k]]}),t})()}}]);