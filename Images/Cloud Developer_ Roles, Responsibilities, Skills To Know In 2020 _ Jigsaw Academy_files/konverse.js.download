var serverURL="https://app.konverse.ai/static_assets";function setCookie(cname,cvalue,minutes,isActual){cvalue=cvalue+"";var d=new Date();if(isActual){d=minutes}else{d.setTime(d.getTime()+(minutes*60*1000))}
var expires="expires="+d.toUTCString();if(document.domain.indexOf("localhost")>-1&&document.domain.indexOf(".")>-1){const domain="domain="+(document.domain.match(/[^\.]*\.[^.]*$/)[0])+";";document.cookie=cname+"="+cvalue+";"+expires+";path=/"+";"+domain}if(document.domain.indexOf("localhost")>-1){const domain="domain=localhost";document.cookie=cname+"="+cvalue+";"+expires+";path=/"+";"+domain}else{const domain="domain="+document.domain;document.cookie=cname+"="+cvalue+";"+expires+";path=/"}}
function getCookie(cname){var name=cname+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1)}
if(c.indexOf(name)==0){return c.substring(name.length,c.length)}}
return""}(function(d){var refId=d.getElementById("konverse-ref-id");if(!refId){console.error("Ref ID not found");return}
var rel=refId.getAttribute("rel");if(rel&&rel.toLowerCase()=="nofollow"){console.error("rel=\"nofollow\" not allowed");return}
var href=refId.getAttribute("href");if(href&&href.toLowerCase()!="https://www.konverse.ai/"){console.error("Konverse reference must point to https://www.konverse.ai/");return}
var accountId=refId.getAttribute("data-bot-id");if(!accountId){console.error("Konverse account id not found");return}
var title=refId.getAttribute("title");if(!title||(title&&title.trim()=="")){console.error("Konverse reference must have a title");return}
var html=refId.innerHTML;if(!html||(html&&html.trim()=="")){console.error("Konverse reference must have a name");return}
var container=document.createElement('div');container.setAttribute("id","konverse-container");document.body.appendChild(container);var url="https://app.konverse.ai/thor/"+accountId+"?current_url="+encodeURIComponent(window.location.href)+"&current_title="+encodeURIComponent(document.title);var head=document.getElementsByTagName('head')[0];var konversecsslink=document.createElement('link');konversecsslink.rel='stylesheet';konversecsslink.type='text/css';konversecsslink.href=serverURL+'/css/widget_v2.css';konversecsslink.media='all';head.appendChild(konversecsslink);var d=document;var s=d.createElement("iframe");s.id=id="konverse-chat-frame";s.setAttribute("frameborder",0);s.setAttribute("allow","microphone");var t=d.getElementById("konverse-container");t.appendChild(s);s.contentWindow.location=url;if(getCookie(accountId+"_RGST")==""){console.log("new conversation",accountId+"_RGST",getCookie(accountId+"_RGST"))
setTimeout(function(){s.contentWindow.postMessage({"type":"new conversation","entityID":accountId,"senderID":getCookie("konverse-id-"+accountId)},"*")},1500)}else if(getCookie("konverse-id-"+accountId)>""){console.log("set-identity",accountId+"_RGST",getCookie("konverse-id-"+accountId))
setTimeout(function(){s.contentWindow.postMessage({"type":"set-identity","entityID":accountId,"senderID":getCookie("konverse-id-"+accountId),"started":getCookie(accountId+"_CSTD")},"*")},1500)}else{console.log("set-identity1",accountId+"_RGST",getCookie("konverse-id-"+accountId));console.log("new conversation1",accountId+"_RGST",getCookie(accountId+"_RGST"))}
var eventMethod=window.addEventListener?"addEventListener":"attachEvent";var eventer=window[eventMethod];var messageEvent=eventMethod==="attachEvent"?"onmessage":"message";eventer(messageEvent,function(e){var container=document.querySelector("#konverse-container");switch(e.data.event){case "open":container.classList.add("k-fadeFirst")
container.classList.add("k-active");container.style.width=e.data.width;container.style.height=e.data.height;break;case "close":container.classList.remove("k-active");container.classList.remove("k-fadeFirst");container.style.width="66px";container.style.height="66px";break;case "start":container.style.width="320px";container.style.height="66px";container.style.height=e.data.height;break;case "cookie":setCookie(e.data.cookie.cookieName,e.data.cookie.cookieValue,e.data.cookie.expiredDate,!0);break}})})(document)